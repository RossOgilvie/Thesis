%!TEX root = thesis_single.tex

\section{Extension Calculations}
\label{sec:Extension Calculations}

REMOVE:\todo{remove} Expectations of things a reader should have in their head when they read this section. They should have an idea of where the $ε$ coordinate comes from, and how the plane $ε=0$ `corresponds' to the line $k=1, v' = -u$. So that extending to $ε=0$ is essentially blowing-up that line. Should know which parts of each coordinate system map to one another, and in particular how we are avoiding $v'=\infty$, and how it sufficient even though we avoid this plane.

The purpose of this appendix is to demonstrate the smooth extension of a class of functions. This is used in section REF \todo{ref}. These functions are defined initially on the coordinates chart $U := \{(k,u,v') \in \R^3 \mid k\in (0,1), u\in\R, v'\in\R, uv' \neq 1\}$. Consider a second coordinate chart $V := \{(ε,ψ,λ) \in \R^3 \mid ε>0, εψλ \neq 1 \}$, with the change of coordinates given by
\begin{align*}
k &= 1 - \exp\bra{-\frac{1}{ε}},
    & ε &= -1/ \ln (1-k), \\
u &= ψ,
    & ψ &= u, \\
v' &= \frac{ψ+λε}{εψλ - 1},
    & λ &= -\ln (1-k) \frac{u+v'}{uv'-1}.
\end{align*}
A geometric explanation of these coordinates can also be found in section REF \todo{ref}. For our purposes, one need only note that as $ε\to 0^+$, $k \to 1^-$ and vice versa. We are interested in extending the pullbacks of functions of $(k,u,v')$, which are defined for $ε>0$, to all values of $ε$. Abstractly, we may consider functions on an open half space $\R^n_{>0} := \{ (x_1, \dots, x_n) \in \R^n \mid x_n > 0\}$ and ask when they can be extended to the whole space $\R^n$. A first step in extending a smooth function on the open half space $\R^n_{>0}$ is to extend it to the closed half space $\R^n_{\geq 0} := \{ (x_1, \dots, x_n) \in \R^n \mid x_n \geq 0\}$. This motivates the following definition.

\begin{defn}
A continuous function on $\R^n_{>0}$ is said to have a \emph{continuous limit} as $x_n \to 0^+$ if it is the restriction of a continuous function on $\R^n_{\geq 0}$.
\end{defn}

Given a smooth function on $\R^n_{>0}$ with a continuous limit and whose derivatives to all orders also have continuous limits, there is a theorem due to Seeley \cite{Seeley1964} that states it has a smooth extension to $\R^n$. Moreover, the theorem is local in nature, so that one needs only a function on a neighbourhood of $x_n=0$. Returning to our specific context, there are three classes of functions that we will show are extensible. Our approach will be to first show that all the functions have continuous limits as $ε\to 0^+$ and then that the classes taken together are closed under differentiation. Inductively then, it will follow that the functions are have continuous limit to all orders and so by Seeley will have smooth extensions.

For two of the three classes of functions is it straightforward to show extensibility. Let $\mathcal{F}_\text{good}$ be smooth functions of $(ε,ψ,λ)$ on a neighbourhood of $ε=0$, restricted to $V$. These functions have the best possible behaviour; by definition they have continuous limits as $ε\to 0^+$, and their derivatives to all orders also lie in $\mathcal{F}_\text{good}$.

Let us take a moment to refresh our familiarity a particular family of functions in $\mathcal{F}_\text{good}$, namely $ε^{-n}\exp(-1/ε)$. It is well known that one can extend any of these functions to $ε\leq 0$ by defining it to be $0$ and that the result a smooth function. Regardless, we reproduce this result below.
\begin{lem}\label{lem:limit_exp}
For all $n \in \N$, as $ε\to 0^+$ the following is true
\[
\lim_{ε\to 0^+} ε^{-n}\exp(-1/ε) = 0.
\]
In particular, the function
\[
\tilde f(ε) =
\begin{cases}
ε^{-n}\exp(-1/ε) & \text{ for } ε > 0, \\
0 & \text{ for } ε \leq 0.
\end{cases}
\]
is a smooth function for all $ε\in\R$.

\begin{proof}
Fix $n\in\N$. For positive values of $x$, comparing $\exp x$ to its Taylor series shows that
\[
\exp x \geq \frac{x^{n+1}}{(n+1)!}.
\]
Letting $x = 1/ε$, we manipulate the limit thus
\begin{align*}
\lim_{ε\to 0^+} ε^{-n}\exp(-1/ε)
&= \lim_{x \to \infty} \frac{x^n}{\exp x} \\
&\leq \lim_{x \to \infty} x^n\frac{(n+1)!}{x^{n+1}} \\
&= (n+1)! \lim_{x \to \infty} \; x^{-1} \\
&= 0.
\end{align*}
As it was a positive expression, the limit is forced to be zero.

The derivative of $ε^{-n}\exp(-1/ε)$ is $-n ε^{-n-1}\exp(-1/ε) + ε^{-n-2} \exp(-1/ε)$, so the linear span of these functions is closed under differentiation. This allows us to conclude that these functions are zero to all orders at $ε=0$, and so $\tilde f$ is smooth at $ε=0$. As the composite of smooth functions, it is smooth for $ε \neq 0$ as well.
\end{proof}
\end{lem}



Similar to $\mathcal{F}_\text{good}$, consider smooth functions $g$ of $(x,y,z) \in \R^3$ defined on a neighbourhood of $x=1$, restricted to $x<1$. Consider the function on $U$ given by $g(k,u,v')$. Define $\mathcal{F}_\text{bad}$ to be the pullbacks of such functions to $V$. We can see that any $f \in \mathcal{F}_\text{bad}$ has a continuous limit as $ε\to 0^+$ by the following trick. Let
\[
\tilde{k}(ε) =
\begin{cases}
k(ε) & \text{ for } ε > 0, \\
1 & \text{ for } ε \leq 0.
\end{cases}
\]
Noting that $\tilde k = 1 - \tilde f$, by \ref{lem:limit_exp} it is a smooth function of $ε\in\R$. If $f$ is the pullback of $g$, then we may write
\[
f(ε,ψ,λ) = g(k(ε), u(s), v'(ε,ψ,λ)) = g(\tilde{k}(ε), u(s), v'(ε,ψ,λ))
\]
where the second equality holds on the domain $ε>0$. However unlike $k$, $\tilde{k}$ is a smooth function at $ε=0$ and so we can see that $f$ extends to a smooth function that is well defined at $ε=0$ because we have written it as the composite of smooth functions. In particular, it has a continuous limit. In subsequent calculations we may use this trick to treat these functions as well defined at $ε=0$ even though strictly speaking $k(0)$ is not well defined.

The derivatives of these functions with respect to $(k,u,v')$ have also smooth functions and so lie in $\mathcal{F}_\text{bad}$. However, we are interested their derivatives with respect to $(ε,ψ,λ)$.

\begin{lem}\label{lem:bad_deriv}
Consider the algebra generated by $\mathcal{F}_\text{good} \cup \mathcal{F}_\text{bad}$. This algebra is closed under differentiation with respect to $(ε,ψ,λ)$.

\begin{proof}
By the product rule it is sufficient to check this on the generators, and we have already shown it for $\mathcal{F}_\text{good}$. This is easily demonstrated for $\mathcal{F}_\text{bad}$ by expressing the $(ε,ψ,λ)$ derivatives in terms of their $(k,u,v')$ counterparts.
\begin{align*}
    \Partial{}{ε}
    &= \Partial{k}{ε}\Partial{}{k} + \Partial{v'}{ε}\Partial{}{v'} \\
    &= -ε^{-2} \exp(-1/ε) \Partial{}{k} - λ \frac{ψ^2 + 1}{(εψλ-1)^2} \Partial{}{v'}, \\
    %%%%%%%%%
    \Partial{}{s}
    &= \Partial{u}{s}\Partial{}{u} + \Partial{v'}{s}\Partial{}{v'} \\
    &= \Partial{}{u} - \frac{1 + ε^2λ^2}{(εψλ-1)^2} \Partial{}{v'}, \\
    %%%%%%%%%
    \Partial{}{c}
    &= \Partial{v'}{c}\Partial{}{v'} \\
    &= - ε \frac{ψ^2 + 1}{(εψλ-1)^2} \Partial{}{v'}.
\end{align*}
Note that the coefficient functions above lie in $\mathcal{F}_\text{good}$ and we have already explained that the partial derivatives with respect to $(k, u, v')$ lie in $\mathcal{F}_\text{bad}$. Hence the derivatives of $\mathcal{F}_\text{good} \cup \mathcal{F}_\text{bad}$ are contained in the algebra as claimed.
\end{proof}
\end{lem}


We now introduce the third class of functions. This is collection of functions that arise in the context of section REF \todo{ref} and that need to be dealt with on a case by case basis. We set
\[
\mathcal{F}_\text{ugly} := \left\{ E(k),\;\; εK(k) \text{ and, } \frac{1}{ε}\frac{1}{k(1+k)} E - K \right\},
\]
and in the first instance we will demonstrate that they each have a well defined limiting value as $ε\to 0^+$. The first two limits require knowledge of elliptic integrals, but are not especially delicate.
\begin{lem}\label{lem:limit_ugly_1}
For $k(ε) = 1 - \exp(-1/ε)$, as $ε\to 0^+$ the following is true
\[
\lim_{ε\to 0^+} E(k) = 1 \text{ and, } \lim_{ε\to 0^+} εK(k) = \frac{1}{2}.
\]
In particular, considered as functions of $(ε,ψ,λ)$, the functions $E(k(ε))$ and $εK(k(ε))$ have continuous limits as $ε \to 0^+$.

\begin{proof}
$E(k)$ is continuous on $[0,1]$ and at $k=1$ it takes the value $1$. Using the trick whereby we extend $k$, the limit is established. For the next function, we recall a fact about the growth of $K(k)$ near $k=1$. In \cite{Anderson} they demonstrate that
\[
\lim_{k \to 1^-} K + \ln\sqrt{1-k^2} = \ln 4,
\]
which, since
\[
\ln\sqrt{1-k^2} = \frac{1}{2}\ln(1-k) + \frac{1}{2}\ln(1+k),
\]
may be rearranged to give
\[
\lim_{k \to 1^-} K + \frac{1}{2}\ln(1-k) = \ln 4 - \frac{1}{2}\ln 2 = \frac{3}{2}\ln 2, \labelthis{eqn:order K}
\]
Mulitplying by $ε$, which recall is $-1/\ln(1-k)$, gives
\begin{align*}
\lim_{ε \to 0^+} εK + \frac{1}{2}ε\ln(1-k) &= \lim_{ε \to 0^+} ε\frac{3}{2}\ln 2 \\
\lim_{ε \to 0^+} εK - \frac{1}{2} &= 0 \\
\lim_{ε \to 0^+} εK &= \frac{1}{2}.
\end{align*}
\end{proof}
\end{lem}

There is an expression that appears in numerous places, namely $
ε^{-n}K(k)\exp(-1/ε)$. This has a limit of $0$ as $ε\to 0^+$ as we may rewrite it as
\[
ε^{-n}K(k)\exp(-1/ε) = εK \times ε^{-n-1}\exp(-1/ε).
\]
For the purposes of quoting it elsewhere, we state it as a lemma using the $k$ variable.
\begin{lem}\label{lem:lim(1-k)K}
For any $n\in\N$, as $k \to 1$, the function $(1-k) \bra{\ln (1-k)}^n K(k)$ tends to $0$.
\end{lem}

The final function of $\mathcal{F}_\text{ugly}$ is the most difficult to deal with. Both terms are divergent, and one must not only show that they cancel one another but show it with enough finesse to extract the value of the limit.
\begin{lem} \label{lem:limit_ugly_2}
For $k(ε) = 1 - \exp(-1/ε)$,
\[
\lim_{ε\to 0^+} \frac{1}{ε}\frac{1}{k(1+k)} E - K = -\frac{3}{2}\ln 2.
\]
In particular, it has a continuous limit as $ε \to 0^+$.

\begin{proof}
We may simplify the limit by making the following comparison.
\begin{align*}
\lim_{ε \to 0^+} \frac{1}{ε}\frac{1}{k(1+k)} - \frac{1}{2ε}
&= \lim_{ε \to 0^+} \frac{1}{ε}\frac{2-k-k^2}{2k(1+k)} \\
&= \lim_{ε \to 0^+} \frac{1}{ε}\frac{(1-k)(2+k)}{2k(1+k)} \\
&= \lim_{ε \to 0^+} ε^{-1}\exp\bra{-1/ε} \frac{2+k}{2k(1+k)} \\
&= 0.
\end{align*}
This limit follows from the earlier result that $ε^{-n} \exp(-1/ε)$ tends to zero, and the other factor tends to $3/4$. Inserting this into the limit calculation yields
\[
\lim_{ε\to 0^+} \frac{1}{ε}\frac{1}{k(1+k)} E - K
= \lim_{ε\to 0^+} \frac{1}{ε}\frac{1}{k(1+k)} E - \frac{1}{2ε}E + \frac{1}{2ε} E - K
= \lim_{ε\to 0^+} \frac{1}{2ε} E - K.
\]
Recall that $E(k)$ is a decreasing function, and that $E(1) = 1$. This provides a lower bound for $E$. Also recall the inequality \todo{ref}, which provides an upper bound. Together
\[
1 \leq E \leq k^2 + (1-k^2)K.
\]
We will loosen the upper bound by noting $k^2 \leq 1$. Let us manipulate this into the desired function.
\begin{align*}
1 \leq E &\leq 1 + (1-k^2)K \\
\frac{1}{2ε} \leq \frac{1}{2ε}E &\leq \frac{1}{2ε}\bra{1 + (1-k^2)K} \\
\frac{1}{2ε} - K \leq \frac{1}{2ε}E - K &\leq \frac{1}{2ε}\bra{1 + (1-k^2)K} - K \\
&= \frac{1}{2ε}(1-k^2)K + \frac{1}{2ε} - K\\
&= \frac{1}{2}(1+k)Kε^{-1}\exp(-1/ε) + \frac{1}{2ε} - K .
\end{align*}
As previously discussed, the first term of the right hand side tends to zero in the limit. Hence
\[
\lim_{ε\to 0^+} \frac{1}{2ε} E - K = \lim_{ε\to 0^+} \frac{1}{2ε} - K.
\]
This final limit has actually already been computed in the previous lemma. In particular, if you recognise that $\ln(1-k) = -1/ε$ then it is the negation of equation \eqref{eqn:order K}. To summarise the steps we have taken
\[
\lim_{ε\to 0^+} \frac{1}{ε}\frac{1}{k(1+k)} E - K
= \lim_{ε\to 0^+} \frac{1}{2ε} E - K
= \lim_{ε\to 0^+} \frac{1}{2ε} - K
= -\frac{3}{2}\ln 2.
\]
\end{proof}
\end{lem}

We have now examined each function of $\mathcal{F}_\text{ugly}$ in turn and shown that they each have a continuous limit as $ε\to 0^+$. Next we must show the derivatives of functions in $\mathcal{F}_\text{ugly}$ are combinations of well behaved functions and other functions of $\mathcal{F}_\text{ugly}$.
















\begin{lem} \label{lem:ugly_deriv}
The first derivatives of the functions in $\mathcal{F}_\text{ugly}$ with respect to $(ε,ψ,λ)$ are in the algebra generated by $\mathcal{F}_\text{bad}\cup\mathcal{F}_\text{ugly}$.

\begin{proof}
We will prove this lemma by direct computation. Note that the functions in $\mathcal{F}_\text{ugly}$ are functions of $ε$ alone, though perhaps mediated via $k$. It is therefore useful to note the total derivative is given by
\[
\frac{d}{dε} = \Partial{}{ε} +\Partial{k}{ε}\Partial{}{k} =\Partial{}{ε} - ε^{-2}\exp(-1/ε)\Partial{}{k}.
\]
It is also worth recalling \todo{ref} the derivatives of the elliptic integrals
\[
\frac{d}{dk}K = \frac{1}{k(1-k^2)}E - \frac{1}{k}K,
\;\;\;
\frac{d}{dk}E = \frac{1}{k}(E-K).
\]
It remains to do the computation. The first two are routine.
\begin{align*}
\frac{d}{dε}E
&= -ε^{-2}\exp(-1/ε)\frac{1}{k}(E-K) \\
&= -\frac{1}{k}E ε^{-2}\exp(-1/ε) + \frac{1}{k} ε^{-2} K \exp(-1/ε).
\end{align*}
And
\begin{align*}
\frac{d}{dε}(εK)
&= K - ε^{-2}\exp(-1/ε) \times ε \bra{ \frac{1}{k(1-k^2)} E - \frac{1}{k} } \\
&= - \bra{ \frac{1}{ε} \frac{1}{k(1+k)} E - K } + \frac{1}{k} ε^{-1} K \exp(-1/ε).
\end{align*}
Each of these derivatives is exhibited as a combination of functions from $\mathcal{F}_\text{bad}$ or $\mathcal{F}_\text{ugly}$. The final derivative we must compute is little larger but holds no surprises.
\begin{align*}
\frac{d}{dε} \bra {\frac{1}{ε}\frac{1}{k(1+k)} E - K}
&= -ε^{-2}\frac{1}{k(1+k)}E - ε^{-3}\exp(-1/ε)\bra{ - \frac{1}{k^2(1+k)}E - \frac{1}{k(1+k)^2}E + \frac{1}{k^2(1+k)}E - \frac{1}{k^2(1+k)}K }
\\ &
+ ε^{-2}\exp(-1/ε) \bra{ \frac{1}{k(1-k^2)}E - \frac{1}{k} K  } \\
&= \frac{1}{k(1+k)^2}E ε^{-3}\exp(-1/ε) + \frac{1}{k^2(1+k)}ε^{-3} K \exp(-1/ε)
- \frac{1}{k} ε^{-2}K\exp(-1/ε)
\end{align*}
This concludes the check for the $ε$-derivatives. The derivatives with respect to the other variables are simply $0$.
\end{proof}
\end{lem}




At this point we have shown that functions in all three classes have continuous limits as $ε \to 0^+$ and have found which spaces their derivative lie in. Therefore we are ready to make an induction argument to generalise to their all derivatives (of any order) and thus conclude that these functions are extensible.

\begin{lem}
Consider the algebra of functions $\mathcal{F}$ generated by $\mathcal{F}_\text{good} \cup \mathcal{F}_\text{bad} \cup \mathcal{F}_{\text{ugly}}$. The functions in $\mathcal{F}$, and their derivatives to all orders, have continuous limits as $ε \to 0^+$. Hence functions in $\mathcal{F}$ are extensible.

\begin{proof}
We have already seen that all functions in $\mathcal{F}$ have continuous limits as $ε \to 0^+$ (Lemmata \ref{lem:limit_ugly_1}, \ref{lem:limit_ugly_2}). Again, to show that this algebra is closed under differentiation it is sufficient to show this on the generators. We have also seen that their first derivatives are contained within this algebra ($\mathcal{F}_\text{good}$ is trivial, Lemmata \ref{lem:bad_deriv}, \ref{lem:ugly_deriv}). Inductively then, all derivatives to all orders are contained in the algebra, and therefore have continuous limits as $ε \to 0^+$. Hence every function meets the conditions of the theorem of Seeley, proving the lemma.
\end{proof}
\end{lem}
